import{n as Q,l as ue,o as ie,e as X,_ as de,R as me,u as pe,c as fe,d as _e,p as ge,i as ve,P as be,j as he,k as ye}from"./business-CYGO-Esk.js";import{d as K,az as G,aA as W,a as z,$ as t,aI as O,ae as Y,o as N,c as F,w as a,f as o,g as M,t as w,h as e,e as P,aC as Z,B as j,aE as ee,aF as L,p as ke,b as J,J as oe,K as te,aG as V,Q as we,ar as xe,I as ae,aJ as Ae,aK as Ce,aH as Se}from"./index-Bd7waQnO.js";import{u as De,a as Re,_ as le,F as ne}from"./form-utxDRKEj.js";import{S as Ie,C as se}from"./index-D8fl3xnZ.js";import{_ as Me,a as Ne}from"./round-refresh-BnO8GhPw.js";import{_ as Te,a as Be}from"./index-DM1RhyVz.js";import{T as Ue}from"./index-5BxRhnMZ.js";import"./Col-BBDQyIt-.js";import"./responsiveObserve-Bb_p94FE.js";const $e={class:"flex-y-center gap-16px pb-12px"},Fe=K({name:"MenuAuthModal",__name:"menu-auth-modal",props:G({roleId:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:["update:visible"],setup(g){const x=g,r=W(g,"visible");function d(){r.value=!1}const v=z(()=>t("common.edit")+t("page.manage.role.menuAuth")),k=O("");async function T(){console.log(x.roleId),k.value="home"}async function u(s){k.value=s}const b=O([]);async function h(){const{error:s,data:l}=await ue();s||(b.value=l)}const y=z(()=>b.value.map(l=>({label:l,value:l}))),_=O([]);async function m(){const{error:s,data:l}=await ie();s||(_.value=D(l))}function D(s){return s.map(l=>{const{id:B,label:$}=l;return l.children?{key:B,title:$,children:D(l.children)}:{key:B,title:$}})}const n=O([]);async function R(){console.log(x.roleId),n.value=[1,2,3,4,5,6,7,8,9,10,11,12,14,15,16,17,18,19,20,21]}function C(){var s,l;console.log(n.value,x.roleId),(l=(s=window.$message)==null?void 0:s.success)==null||l.call(s,t("common.modifySuccess")),d()}async function U(){T(),h(),await m(),await R()}return Y(r,s=>{s&&U()}),(s,l)=>{const B=Z,$=Q,A=j,i=ee;return N(),F(i,{open:r.value,"onUpdate:open":l[1]||(l[1]=c=>r.value=c),title:v.value,class:"w-480px"},{footer:a(()=>[o(A,{size:"small",class:"mt-16px",onClick:d},{default:a(()=>[M(w(e(t)("common.cancel")),1)]),_:1}),o(A,{type:"primary",size:"small",class:"mt-16px",onClick:C},{default:a(()=>[M(w(e(t)("common.confirm")),1)]),_:1})]),default:a(()=>[P("div",$e,[P("div",null,w(e(t)("page.manage.menu.home")),1),o(B,{value:k.value,options:y.value,class:"w-240px","onUpdate:value":u},null,8,["value","options"])]),o($,{"checked-keys":n.value,"onUpdate:checkedKeys":l[0]||(l[0]=c=>n.value=c),"tree-data":_.value,checkable:"",height:280,class:"h-280px"},null,8,["checked-keys","tree-data"])]),_:1},8,["open","title"])}}}),Oe=K({name:"ButtonAuthModal",__name:"button-auth-modal",props:G({roleId:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:["update:visible"],setup(g){const x=g,r=W(g,"visible");function d(){r.value=!1}const v=z(()=>t("common.edit")+t("page.manage.role.buttonAuth")),k=O([]);async function T(){k.value=[{key:1,title:"button1",code:"code1"},{key:2,title:"button2",code:"code2"},{key:3,title:"button3",code:"code3"},{key:4,title:"button4",code:"code4"},{key:5,title:"button5",code:"code5"},{key:6,title:"button6",code:"code6"},{key:7,title:"button7",code:"code7"},{key:8,title:"button8",code:"code8"},{key:9,title:"button9",code:"code9"},{key:10,title:"button10",code:"code10"}]}const u=O([]);async function b(){console.log(x.roleId),u.value=[1,2,3,4,5]}function h(){var _,m;console.log(u.value,x.roleId),(m=(_=window.$message)==null?void 0:_.success)==null||m.call(_,t("common.modifySuccess")),d()}function y(){T(),b()}return y(),(_,m)=>{const D=Q,n=j,R=ee;return N(),F(R,{open:r.value,"onUpdate:open":m[1]||(m[1]=C=>r.value=C),title:v.value,class:"w-480px"},{footer:a(()=>[o(n,{size:"small",class:"mt-16px",onClick:d},{default:a(()=>[M(w(e(t)("common.cancel")),1)]),_:1}),o(n,{type:"primary",size:"small",class:"mt-16px",onClick:h},{default:a(()=>[M(w(e(t)("common.confirm")),1)]),_:1})]),default:a(()=>[o(D,{"checked-keys":u.value,"onUpdate:checkedKeys":m[0]||(m[0]=C=>u.value=C),"tree-data":k.value,checkable:"",height:280,class:"h-280px"},null,8,["checked-keys","tree-data"])]),_:1},8,["open","title"])}}}),ze={class:"flex-y-center justify-end gap-12px"},Pe=K({name:"RoleOperateDrawer",__name:"role-operate-drawer",props:G({operateType:{},rowData:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:G(["submitted"],["update:visible"]),setup(g,{emit:x}){const r=g,d=x,v=W(g,"visible"),{formRef:k,validate:T,resetFields:u}=De(),{defaultRequiredRule:b}=Re(),{bool:h,setTrue:y}=L(),{bool:_,setTrue:m}=L(),D=z(()=>({add:t("page.manage.role.addRole"),edit:t("page.manage.role.editRole")})[r.operateType]),n=ke(R());function R(){return{roleName:"",roleCode:"",roleDesc:"",status:"1"}}const C={roleName:b,roleCode:b,status:b},U=z(()=>{var A;return((A=r.rowData)==null?void 0:A.id)||-1}),s=z(()=>r.operateType==="edit");async function l(){Object.assign(n,R()),r.operateType==="edit"&&r.rowData&&(await xe(),Object.assign(n,r.rowData))}function B(){v.value=!1}async function $(){var A;await T(),(A=window.$message)==null||A.success(t("common.updateSuccess")),B(),d("submitted")}return Y(v,()=>{v.value&&(l(),u())}),(A,i)=>{const c=ae,p=le,S=me,E=de,H=ne,I=j,re=Ie,ce=Ae;return N(),F(ce,{open:v.value,"onUpdate:open":i[6]||(i[6]=f=>v.value=f),title:D.value,width:360},{footer:a(()=>[P("div",ze,[o(I,{onClick:B},{default:a(()=>[M(w(e(t)("common.cancel")),1)]),_:1}),o(I,{type:"primary",onClick:$},{default:a(()=>[M(w(e(t)("common.confirm")),1)]),_:1})])]),default:a(()=>[o(H,{ref_key:"formRef",ref:k,layout:"vertical",model:n,rules:C},{default:a(()=>[o(p,{label:e(t)("page.manage.role.roleName"),name:"roleName"},{default:a(()=>[o(c,{value:n.roleName,"onUpdate:value":i[0]||(i[0]=f=>n.roleName=f),placeholder:e(t)("page.manage.role.form.roleName")},null,8,["value","placeholder"])]),_:1},8,["label"]),o(p,{label:e(t)("page.manage.role.roleCode"),name:"roleCode"},{default:a(()=>[o(c,{value:n.roleCode,"onUpdate:value":i[1]||(i[1]=f=>n.roleCode=f),placeholder:e(t)("page.manage.role.form.roleCode")},null,8,["value","placeholder"])]),_:1},8,["label"]),o(p,{label:e(t)("page.manage.role.roleStatus"),name:"status"},{default:a(()=>[o(E,{value:n.status,"onUpdate:value":i[2]||(i[2]=f=>n.status=f)},{default:a(()=>[(N(!0),J(te,null,oe(e(X),f=>(N(),F(S,{key:f.value,value:f.value},{default:a(()=>[M(w(e(t)(f.label)),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1},8,["label"]),o(p,{label:e(t)("page.manage.role.roleDesc"),name:"roleDesc"},{default:a(()=>[o(c,{value:n.roleDesc,"onUpdate:value":i[3]||(i[3]=f=>n.roleDesc=f),placeholder:e(t)("page.manage.role.form.roleDesc")},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1},8,["model"]),s.value?(N(),F(re,{key:0},{default:a(()=>[o(I,{onClick:e(y)},{default:a(()=>[M(w(e(t)("page.manage.role.menuAuth")),1)]),_:1},8,["onClick"]),o(Fe,{visible:e(h),"onUpdate:visible":i[4]||(i[4]=f=>V(h)?h.value=f:null),"role-id":U.value},null,8,["visible","role-id"]),o(I,{onClick:e(m)},{default:a(()=>[M(w(e(t)("page.manage.role.buttonAuth")),1)]),_:1},8,["onClick"]),o(Oe,{visible:e(_),"onUpdate:visible":i[5]||(i[5]=f=>V(_)?_.value=f:null),"role-id":U.value},null,8,["visible","role-id"])]),_:1})):we("",!0)]),_:1},8,["open","title"])}}}),je={class:"w-full flex-y-center justify-end gap-12px"},Ve={class:"ml-8px"},Ge={class:"ml-8px"},Ke=K({name:"RoleSearch",__name:"role-search",props:{model:{required:!0},modelModifiers:{}},emits:G(["reset","search"],["update:model"]),setup(g,{emit:x}){const r=x,d=W(g,"model");function v(){r("reset")}function k(){r("search")}return(T,u)=>{const b=ae,h=le,y=Te,_=Ce,m=Z,D=Me,n=j,R=Ne,C=Be,U=ne,s=se;return N(),F(s,{title:e(t)("common.search"),bordered:!1,class:"card-wrapper"},{default:a(()=>[o(U,{model:d.value,"label-width":80},{default:a(()=>[o(C,{gutter:[16,16],wrap:""},{default:a(()=>[o(y,{span:24,md:12,lg:6},{default:a(()=>[o(h,{label:e(t)("page.manage.role.roleName"),name:"roleName",class:"m-0"},{default:a(()=>[o(b,{value:d.value.roleName,"onUpdate:value":u[0]||(u[0]=l=>d.value.roleName=l),placeholder:e(t)("page.manage.role.form.roleName")},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1}),o(y,{span:24,md:12,lg:6},{default:a(()=>[o(h,{label:e(t)("page.manage.role.roleCode"),name:"roleCode",class:"m-0"},{default:a(()=>[o(b,{value:d.value.roleCode,"onUpdate:value":u[1]||(u[1]=l=>d.value.roleCode=l),placeholder:e(t)("page.manage.role.form.roleCode")},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1}),o(y,{span:24,md:12,lg:6},{default:a(()=>[o(h,{label:e(t)("page.manage.role.roleStatus"),name:"status",class:"m-0"},{default:a(()=>[o(m,{value:d.value.status,"onUpdate:value":u[2]||(u[2]=l=>d.value.status=l),placeholder:e(t)("page.manage.role.form.roleStatus"),"allow-clear":""},{default:a(()=>[(N(!0),J(te,null,oe(e(X),l=>(N(),F(_,{key:l.value,value:l.value},{default:a(()=>[M(w(e(t)(l.label)),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","placeholder"])]),_:1},8,["label"])]),_:1}),o(y,{span:24,md:12,lg:6},{default:a(()=>[o(h,{class:"m-0"},{default:a(()=>[P("div",je,[o(n,{onClick:v},{icon:a(()=>[o(D,{class:"align-sub text-icon"})]),default:a(()=>[P("span",Ve,w(e(t)("common.reset")),1)]),_:1}),o(n,{type:"primary",ghost:"",onClick:k},{icon:a(()=>[o(R,{class:"align-sub text-icon"})]),default:a(()=>[P("span",Ge,w(e(t)("common.search")),1)]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["title"])}}}),We={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"};function q(g){return typeof g=="function"||Object.prototype.toString.call(g)==="[object Object]"&&!Se(g)}const eo=K({name:"manage_role",__name:"index",setup(g){const{tableWrapperRef:x,scrollConfig:r}=pe(),{columns:d,columnChecks:v,data:k,loading:T,getData:u,getDataByPage:b,mobilePagination:h,searchParams:y,resetSearchParams:_}=fe({apiFn:ge,apiParams:{current:1,size:10,status:void 0,roleName:void 0,roleCode:void 0},columns:()=>[{key:"index",dataIndex:"index",title:t("common.index"),width:64,align:"center"},{key:"roleName",dataIndex:"roleName",title:t("page.manage.role.roleName"),align:"center",minWidth:120},{key:"roleCode",dataIndex:"roleCode",title:t("page.manage.role.roleCode"),align:"center",minWidth:120},{key:"roleDesc",dataIndex:"roleDesc",title:t("page.manage.role.roleDesc"),minWidth:120},{key:"status",dataIndex:"status",title:t("page.manage.role.roleStatus"),align:"center",width:100,customRender:({record:c})=>{if(c.status===null)return null;const p={1:"success",2:"warning"},S=t(ve[c.status]);return o(Ue,{color:p[c.status]},q(S)?S:{default:()=>[S]})}},{key:"operate",title:t("common.operate"),align:"center",width:130,customRender:({record:c})=>{let p,S;return o("div",{class:"flex-center gap-8px"},[o(j,{type:"primary",ghost:!0,size:"small",onClick:()=>i(c.id)},q(p=t("common.edit"))?p:{default:()=>[p]}),o(be,{onConfirm:()=>A(c.id),title:t("common.confirmDelete")},{default:()=>[o(j,{danger:!0,size:"small"},q(S=t("common.delete"))?S:{default:()=>[S]})]})])}}]}),{drawerVisible:m,operateType:D,editingData:n,handleAdd:R,handleEdit:C,checkedRowKeys:U,rowSelection:s,onBatchDeleted:l,onDeleted:B}=_e(k,u);async function $(){l()}function A(c){console.log(c),B()}function i(c){C(c)}return(c,p)=>{const S=he,E=ye,H=se;return N(),J("div",We,[o(Ke,{model:e(y),"onUpdate:model":p[0]||(p[0]=I=>V(y)?y.value=I:null),onReset:e(_),onSearch:e(b)},null,8,["model","onReset","onSearch"]),o(H,{title:e(t)("page.manage.role.title"),bordered:!1,"body-style":{flex:1,overflow:"hidden"},class:"flex-col-stretch sm:flex-1-hidden card-wrapper"},{extra:a(()=>[o(S,{columns:e(v),"onUpdate:columns":p[1]||(p[1]=I=>V(v)?v.value=I:null),"disabled-delete":e(U).length===0,loading:e(T),onAdd:e(R),onDelete:$,onRefresh:e(u)},null,8,["columns","disabled-delete","loading","onAdd","onRefresh"])]),default:a(()=>[o(E,{ref_key:"tableWrapperRef",ref:x,columns:e(d),"data-source":e(k),"row-selection":e(s),loading:e(T),"row-key":"id",size:"small",pagination:e(h),scroll:e(r),class:"h-full"},null,8,["columns","data-source","row-selection","loading","pagination","scroll"]),o(Pe,{visible:e(m),"onUpdate:visible":p[2]||(p[2]=I=>V(m)?m.value=I:null),"operate-type":e(D),"row-data":e(n),onSubmitted:e(b)},null,8,["visible","operate-type","row-data","onSubmitted"])]),_:1},8,["title"])])}}});export{eo as default};
