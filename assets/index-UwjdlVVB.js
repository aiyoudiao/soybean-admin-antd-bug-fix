import{q as K,e as Q,f as oe,_ as re,R as ue,u as de,c as me,d as ie,r as pe,s as ce,i as fe,P as ge,j as _e,k as ve}from"./business-CYGO-Esk.js";import{d as W,az as z,aA as X,a as Y,$ as l,p as be,r as he,ae as ye,o as N,c as B,w as n,f as a,g as I,t as P,h as e,b as V,J as q,K as L,ar as ke,I as Z,aC as ee,B as F,aJ as we,aL as H,e as O,aG as j,aH as Ne}from"./index-Bd7waQnO.js";import{u as ae,a as le,_ as ne,F as te}from"./form-utxDRKEj.js";import{S as Re,C as se}from"./index-D8fl3xnZ.js";import{_ as xe,a as Se}from"./round-refresh-BnO8GhPw.js";import{_ as Ae,a as Ge}from"./index-DM1RhyVz.js";import{T as J}from"./index-5BxRhnMZ.js";import"./Col-BBDQyIt-.js";import"./responsiveObserve-Bb_p94FE.js";const Pe=W({name:"UserOperateDrawer",__name:"user-operate-drawer",props:z({operateType:{},rowData:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:z(["submitted"],["update:visible"]),setup(y,{emit:U}){const k=y,C=U,g=X(y,"visible"),{formRef:R,validate:u,resetFields:x}=ae(),{defaultRequiredRule:w}=le(),D=Y(()=>({add:l("page.manage.user.addUser"),edit:l("page.manage.user.editUser")})[k.operateType]),s=be(d());function d(){return{userName:"",userGender:"1",nickName:"",userPhone:"",userEmail:"",userRoles:[],status:"1"}}const _={userName:w,status:w},f=he([]);async function v(){const{error:b,data:o}=await oe();if(!b){const h=o.map(r=>({label:r.roleName,value:r.roleCode})),c=s.userRoles.map(r=>({label:r,value:r}));f.value=[...c,...h]}}async function S(){Object.assign(s,d()),k.operateType==="edit"&&k.rowData&&(await ke(),Object.assign(s,k.rowData))}function A(){g.value=!1}async function G(){var b;await u(),(b=window.$message)==null||b.success(l("common.updateSuccess")),A(),C("submitted")}return ye(g,()=>{g.value&&(S(),x(),v())}),(b,o)=>{const h=Z,c=ne,r=ue,E=re,m=ee,i=te,p=F,M=Re,$=we;return N(),B($,{open:g.value,"onUpdate:open":o[7]||(o[7]=t=>g.value=t),title:D.value,width:360},{footer:n(()=>[a(M,{size:16},{default:n(()=>[a(p,{onClick:A},{default:n(()=>[I(P(e(l)("common.cancel")),1)]),_:1}),a(p,{type:"primary",onClick:G},{default:n(()=>[I(P(e(l)("common.confirm")),1)]),_:1})]),_:1})]),default:n(()=>[a(i,{ref_key:"formRef",ref:R,layout:"vertical",model:s,rules:_},{default:n(()=>[a(c,{label:e(l)("page.manage.user.userName"),name:"userName"},{default:n(()=>[a(h,{value:s.userName,"onUpdate:value":o[0]||(o[0]=t=>s.userName=t),placeholder:e(l)("page.manage.user.form.userName")},null,8,["value","placeholder"])]),_:1},8,["label"]),a(c,{label:e(l)("page.manage.user.userGender"),name:"userGender"},{default:n(()=>[a(E,{value:s.userGender,"onUpdate:value":o[1]||(o[1]=t=>s.userGender=t)},{default:n(()=>[(N(!0),V(L,null,q(e(K),t=>(N(),B(r,{key:t.value,value:t.value},{default:n(()=>[I(P(e(l)(t.label)),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1},8,["label"]),a(c,{label:e(l)("page.manage.user.nickName"),name:"nickName"},{default:n(()=>[a(h,{value:s.nickName,"onUpdate:value":o[2]||(o[2]=t=>s.nickName=t),placeholder:e(l)("page.manage.user.form.nickName")},null,8,["value","placeholder"])]),_:1},8,["label"]),a(c,{label:e(l)("page.manage.user.userPhone"),name:"userPhone"},{default:n(()=>[a(h,{value:s.userPhone,"onUpdate:value":o[3]||(o[3]=t=>s.userPhone=t),placeholder:e(l)("page.manage.user.form.userPhone")},null,8,["value","placeholder"])]),_:1},8,["label"]),a(c,{label:e(l)("page.manage.user.userEmail"),name:"email"},{default:n(()=>[a(h,{value:s.userEmail,"onUpdate:value":o[4]||(o[4]=t=>s.userEmail=t),placeholder:e(l)("page.manage.user.form.userEmail")},null,8,["value","placeholder"])]),_:1},8,["label"]),a(c,{label:e(l)("page.manage.user.userStatus"),name:"status"},{default:n(()=>[a(E,{value:s.status,"onUpdate:value":o[5]||(o[5]=t=>s.status=t)},{default:n(()=>[(N(!0),V(L,null,q(e(Q),t=>(N(),B(r,{key:t.value,value:t.value},{default:n(()=>[I(P(e(l)(t.label)),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1},8,["label"]),a(c,{label:e(l)("page.manage.user.userRole"),name:"roles"},{default:n(()=>[a(m,{value:s.userRoles,"onUpdate:value":o[6]||(o[6]=t=>s.userRoles=t),multiple:"",options:f.value,placeholder:e(l)("page.manage.user.form.userRole")},null,8,["value","options","placeholder"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1},8,["open","title"])}}}),Ue={class:"flex-1"},Ce={class:"w-full flex-y-center justify-end gap-12px"},De={class:"ml-8px"},Ee={class:"ml-8px"},Ie=W({name:"UserSearch",__name:"user-search",props:{model:{required:!0},modelModifiers:{}},emits:z(["reset","search"],["update:model"]),setup(y,{emit:U}){const k=U,{formRef:C,validate:g,resetFields:R}=ae(),u=X(y,"model"),x=Y(()=>{const{patternRules:s}=le();return{userEmail:s.email,userPhone:s.phone}});async function w(){await R(),k("reset")}async function D(){await g(),k("search")}return(s,d)=>{const _=Z,f=ne,v=Ae,S=ee,A=xe,G=F,b=Se,o=Ge,h=te,c=se;return N(),B(c,{title:e(l)("common.search"),bordered:!1,class:"card-wrapper"},{default:n(()=>[a(h,{ref_key:"formRef",ref:C,model:u.value,rules:x.value,"label-col":{span:5,md:7}},{default:n(()=>[a(o,{gutter:[16,16],wrap:""},{default:n(()=>[a(v,{span:24,md:12,lg:6},{default:n(()=>[a(f,{label:e(l)("page.manage.user.userName"),name:"userName",class:"m-0"},{default:n(()=>[a(_,{value:u.value.userName,"onUpdate:value":d[0]||(d[0]=r=>u.value.userName=r),placeholder:e(l)("page.manage.user.form.userName")},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1}),a(v,{span:24,md:12,lg:6},{default:n(()=>[a(f,{label:e(l)("page.manage.user.userGender"),name:"userGender",class:"m-0"},{default:n(()=>[a(S,{value:u.value.userGender,"onUpdate:value":d[1]||(d[1]=r=>u.value.userGender=r),placeholder:e(l)("page.manage.user.form.userGender"),options:e(H)(e(K)),clearable:""},null,8,["value","placeholder","options"])]),_:1},8,["label"])]),_:1}),a(v,{span:24,md:12,lg:6},{default:n(()=>[a(f,{label:e(l)("page.manage.user.nickName"),name:"nickName",class:"m-0"},{default:n(()=>[a(_,{value:u.value.nickName,"onUpdate:value":d[2]||(d[2]=r=>u.value.nickName=r),placeholder:e(l)("page.manage.user.form.nickName")},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1}),a(v,{span:24,md:12,lg:6},{default:n(()=>[a(f,{label:e(l)("page.manage.user.userPhone"),name:"userPhone",class:"m-0"},{default:n(()=>[a(_,{value:u.value.userPhone,"onUpdate:value":d[3]||(d[3]=r=>u.value.userPhone=r),placeholder:e(l)("page.manage.user.form.userPhone")},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1}),a(v,{span:24,md:12,lg:6},{default:n(()=>[a(f,{label:e(l)("page.manage.user.userEmail"),name:"userEmail",class:"m-0"},{default:n(()=>[a(_,{value:u.value.userEmail,"onUpdate:value":d[4]||(d[4]=r=>u.value.userEmail=r),placeholder:e(l)("page.manage.user.form.userEmail")},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1}),a(v,{span:24,md:12,lg:6},{default:n(()=>[a(f,{label:e(l)("page.manage.user.userStatus"),name:"userStatus",class:"m-0"},{default:n(()=>[a(S,{value:u.value.status,"onUpdate:value":d[5]||(d[5]=r=>u.value.status=r),placeholder:e(l)("page.manage.user.form.userStatus"),options:e(H)(e(Q)),clearable:""},null,8,["value","placeholder","options"])]),_:1},8,["label"])]),_:1}),O("div",Ue,[a(f,{class:"m-0"},{default:n(()=>[O("div",Ce,[a(G,{onClick:w},{icon:n(()=>[a(A,{class:"align-sub text-icon"})]),default:n(()=>[O("span",De,P(e(l)("common.reset")),1)]),_:1}),a(G,{type:"primary",ghost:"",onClick:D},{icon:n(()=>[a(b,{class:"align-sub text-icon"})]),default:n(()=>[O("span",Ee,P(e(l)("common.search")),1)]),_:1})])]),_:1})])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title"])}}}),Oe={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"};function T(y){return typeof y=="function"||Object.prototype.toString.call(y)==="[object Object]"&&!Ne(y)}const qe=W({name:"manage_user",__name:"index",setup(y){const{tableWrapperRef:U,scrollConfig:k}=de(),{columns:C,columnChecks:g,data:R,getData:u,getDataByPage:x,loading:w,mobilePagination:D,searchParams:s,resetSearchParams:d}=me({apiFn:pe,apiParams:{current:1,size:10,status:void 0,userName:void 0,userGender:void 0,nickName:void 0,userPhone:void 0,userEmail:void 0},columns:()=>[{key:"index",title:l("common.index"),dataIndex:"index",align:"center",width:64},{key:"userName",dataIndex:"userName",title:l("page.manage.user.userName"),align:"center",minWidth:100},{key:"userGender",title:l("page.manage.user.userGender"),align:"center",dataIndex:"userGender",width:100,customRender:({record:m})=>{if(m.userGender===null)return null;const i={1:"processing",2:"error"},p=l(ce[m.userGender]);return a(J,{color:i[m.userGender]},T(p)?p:{default:()=>[p]})}},{key:"nickName",dataIndex:"nickName",title:l("page.manage.user.nickName"),align:"center",minWidth:100},{key:"userPhone",dataIndex:"userPhone",title:l("page.manage.user.userPhone"),align:"center",width:120},{key:"userEmail",dataIndex:"userEmail",title:l("page.manage.user.userEmail"),align:"center",minWidth:200},{key:"status",dataIndex:"status",title:l("page.manage.user.userStatus"),align:"center",width:100,customRender:({record:m})=>{if(m.status===null)return null;const i={1:"success",2:"warning"},p=l(fe[m.status]);return a(J,{color:i[m.status]},T(p)?p:{default:()=>[p]})}},{key:"operate",title:l("common.operate"),align:"center",width:130,customRender:({record:m})=>{let i,p;return a("div",{class:"flex-center gap-8px"},[a(F,{type:"primary",ghost:!0,size:"small",onClick:()=>E(m.id)},T(i=l("common.edit"))?i:{default:()=>[i]}),a(ge,{title:l("common.confirmDelete"),onConfirm:()=>r(m.id)},{default:()=>[a(F,{danger:!0,size:"small"},T(p=l("common.delete"))?p:{default:()=>[p]})]})])}}]}),{drawerVisible:_,operateType:f,editingData:v,handleAdd:S,handleEdit:A,checkedRowKeys:G,rowSelection:b,onBatchDeleted:o,onDeleted:h}=ie(R,u);async function c(){o()}function r(m){console.log(m),h()}function E(m){A(m)}return(m,i)=>{const p=_e,M=ve,$=se;return N(),V("div",Oe,[a(Ie,{model:e(s),"onUpdate:model":i[0]||(i[0]=t=>j(s)?s.value=t:null),onReset:e(d),onSearch:e(x)},null,8,["model","onReset","onSearch"]),a($,{title:e(l)("page.manage.user.title"),bordered:!1,"body-style":{flex:1,overflow:"hidden"},class:"flex-col-stretch sm:flex-1-hidden card-wrapper"},{extra:n(()=>[a(p,{columns:e(g),"onUpdate:columns":i[1]||(i[1]=t=>j(g)?g.value=t:null),"disabled-delete":e(G).length===0,loading:e(w),onAdd:e(S),onDelete:c,onRefresh:e(u)},null,8,["columns","disabled-delete","loading","onAdd","onRefresh"])]),default:n(()=>[a(M,{ref_key:"tableWrapperRef",ref:U,columns:e(C),"data-source":e(R),size:"small","row-selection":e(b),scroll:e(k),loading:e(w),"row-key":"id",pagination:e(D),class:"h-full"},null,8,["columns","data-source","row-selection","scroll","loading","pagination"]),a(Pe,{visible:e(_),"onUpdate:visible":i[2]||(i[2]=t=>j(_)?_.value=t:null),"operate-type":e(f),"row-data":e(v),onSubmitted:e(x)},null,8,["visible","operate-type","row-data","onSubmitted"])]),_:1},8,["title"])])}}});export{qe as default};
